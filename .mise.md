# Using mise for Tool Management

This project includes a [`.mise.toml`](.mise.toml) configuration file that defines all required tools and their versions.

## What is mise?

[mise](https://mise.jdx.dev/) is a polyglot tool version manager that replaces tools like asdf, nvm, pyenv, rbenv, etc. It manages all the project's development tools in one place.

## Installation

1. **Install mise** (if not already installed):

   ```bash
   # macOS
   brew install mise

   # Linux
   curl https://mise.run | sh
   ```

2. **Install project tools**:

   ```bash
   cd /path/to/packer-vsphere
   mise install
   ```

3. **Activate mise in your shell** (optional, for automatic environment setup):

   ```bash
   # For current session
   eval "$(mise activate zsh)"  # or bash/fish

   # For permanent activation, add to your shell config
   echo 'eval "$(mise activate zsh)"' >> ~/.zshrc
   ```

## Usage

### With Shell Activation

If you've activated mise in your shell (step 3 above), the tools will be automatically available:

```bash
cd /path/to/packer-vsphere
packer --version
ansible --version
terraform --version
```

### Without Shell Activation

Use `mise exec` to run commands with mise-managed tools:

```bash
mise exec -- packer --version
mise exec -- ansible --version
mise exec -- terraform --version
```

### Useful Commands

```bash
# List installed tools
mise ls

# List all available versions for a tool
mise ls-remote packer

# Update a specific tool
mise upgrade packer

# Update all tools
mise upgrade
```

## Installed Tools

The following tools are managed by mise (as defined in [`.mise.toml`](.mise.toml)):

| Tool      | Version | Description                              |
|-----------|---------|------------------------------------------|
| packer    | 1.12.0  | HashiCorp Packer                         |
| ansible   | latest  | Automation engine (includes ansible-core 2.19.3) |
| terraform | 1.10.0  | Infrastructure as Code tool              |
| gomplate  | 4.3.0   | Template renderer                        |
| jq        | 1.8.1   | Command-line JSON processor              |

## Additional System Requirements

The following tools are **NOT currently managed by mise** and need to be installed via system package manager. These may be added to mise configuration in the future:

- **git** (>= 2.43.0) - Should be managed by system package manager (usually pre-installed)
- **xorriso** (>= 1.5.6) - Linux only, install via system package manager
- **coreutils** - macOS only, install via: `brew install coreutils`

### Installation Instructions

**macOS:**

```bash
# git is usually pre-installed, verify version
git --version

# Install coreutils
brew install coreutils
```

**Linux (Ubuntu/Debian):**

```bash
# Install git if needed
sudo apt install git

# Install xorriso
sudo apt install xorriso
```

**Linux (RHEL/Fedora/CentOS):**

```bash
# Install git if needed
sudo dnf install git

# Install xorriso
sudo dnf install xorriso
```

## Troubleshooting

### Tools not found after installation

Make sure you've either:
1. Activated mise in your shell: `eval "$(mise activate zsh)"`
2. Or use `mise exec --` before commands

### Version conflicts with system tools

mise tools take precedence over system tools when the shell is activated. To use system tools instead, deactivate mise or don't activate it in your shell.

### Check what versions are being used

```bash
mise which packer
mise which ansible
```

## Documentation

- [mise Documentation](https://mise.jdx.dev/)
- [Project Requirements](docs/getting-started/requirements.md)
